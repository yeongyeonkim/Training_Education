# 컨테이너의 이해

**2020/9/21**

#### Docker의 등장 배경과 서버 운영의 미래

- The future of Linux Container **Pycon2013**



### 서버 운영

#### 컨테이너 등장 이전

- 애플리케이션이 동작하는 **상태**를 유지하는 작업

1. 프로비저닝
   - 애플리케이션이 동작하는 **상태**를 만드는 작업
2. 배포
   - 프로비저닝된 서버에서 애플리케이션을 실행
   - 애플리케이션들이 모두 실행 가능한 상태로 만드는 일
3. 서버 운영
   - 배포된 애플리케이션이 동작 가능한 **상태**를 유지



베어 메탈 - 소프트웨어가 설치되지 않은 하드웨어.

---

### <인프라 진화>

### 1. IaaS 

### - 클라우드의 등장, 하드웨어 가상화

- instance - 같은 환경을 가지는 가상화된 환경
- 원하는 만큼 사용 가능한 컴퓨팅 자원
- 이미지화 & 스케일 인/아웃
- Resource Monitoring & Auto Scaling
- 이미지 수의 증가 - 이미지(AMI) 수에 비례해서 관리가 어려워짐 (애플리케이션 수 * 시간)
- 이미지는 어떤 특정 시점의 **상태**를 저장한 것이다.
- 최종적으로 남은 이미지 - 어떻게 만들었는지 아무도 모른다(복원 불가능)

하드웨어파편화문제의해결

가상화된환경만으로아키텍처구성이가능해짐

이미지를기반으로한다수의서버상태관리

상태관리에대한새로운접근

서버운영의문제는여전히그대로남아있음



### 2. Configuration Management 

### - 재현 가능한 서버 상태 관리를 위한 솔루션

* 서버 운영의 추상화
* 명령어를 통한 서버 관리(과거) 지양
* 상태를 관리하는 코드를 작성하고 서버에 적용
* 선언적 서버 상태 정의
* 서버의 상태가 재현 가능해짐(불완전)
* 서버 운영의 협업이 가능해짐



### 3. PaaS

애플리케이션 배포 단위 - 배포 환경은 Heroku가 제공

애플리케이션 별 독립된 배포 환경 제공

Scale in/out 지원

배포의 단순화 - 애플리케이션 개발자는 환경 구축에 신경 쓸 필요가 없다.(개발에만 집중)

(위는 Iaas, 아래는 paas)

확장의 단순화 - Depth만 지정해주면됨. 



- 소스 코드만으로 배포가 가능해짐
- 일반화된 프로비저닝 방법을 제공
  - 프로비저닝 과정에 개입할 수 없음
  - 예) Heroku의 buildpacks
- **서버 운영 없이 애플리케이션이 가능해짐.**

---

### Docker의 등장

#### 컨테이너 기반 가상화 도구

* 컨테이너 : 격리된 환경에서 작동하는 프로세스
  * 리눅스 커널의 기술들을 활용
  * 하드웨어 가상화 기술보다 가벼움
  * 이미지 단위로 프로세스 실행 환경을 구성

`$ docker run - a busybox echo hello world`
`hello world`

docker run으로 실행되는 환경(위에선 busybox)을 바꿔주는 것.
![client_server](.img/client_server.PNG)

- 프로세스 격리. LXC
- 계층화된 저장장치. AUFS
- 이미지 공유. Docker Index

빌드된 이미지 - 호스트의 환경과 무관하게 실행 가능

Rails Container - 프로비저닝이 완료

배포 단위 - Docker Images(자체가 애플리케이션 실행 환경이 됨)

배포 대상 - Docker Servers



<div style="text-align: center;">
    <img style="max-height:60%; max-width:60%;"
         src="C:\Users\yeongyeon.kim\Desktop\Release.PNG">
</div>

개발자가 작성하고 push하면 ci 관리자가

docker file로 빌드.

이미지들을 docker 레지스트리에 다 등록하고

버전별로 A A' B ..... 이미지들이 저장

이미지를 가지고서 서버에 배포 (추후 배울 Kubernates가 서버에 배포를 도와주는 역할)



### 서버 운영의 미래

- **프로비저닝**은 이미지 생성 시점에 완료
- **배포**는 프로비저닝과 별도로 원하는 시점에
- **서버**는 컨테이너를 실행시키기 위한 환경일 뿐(운영 한다거나 하지 않음)
  - 컨테이너 실행을 위한 최소한 환경만을 구성
  - 서버의 상태를 적극적으로 관리하지 않음
- 서버 없이 컨테이너를 실행하는 서비스의 등장
  - **서버 운영의 종말**

